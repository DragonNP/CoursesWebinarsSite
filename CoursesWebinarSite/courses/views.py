import json

from django.contrib.auth.decorators import login_required
from django.http import HttpResponse
from django.shortcuts import render, redirect
from getCourse import GetCourse


def empty(request):
    return redirect('/')


@login_required
def my(request):
    user = request.user
    context = {}

    # mass = []
    # for user_webinar_link in UserWebinarLink.objects.filter(user=user, is_my=True):
    #     webinar = user_webinar_link.webinar
    #
    #     web = [webinar.id, webinar.name]
    #
    #     if webinar.description != '':
    #         web.append(webinar.description)
    #     else:
    #         web.append('')
    #
    #     web.append(webinar.format_date(is_month_name=False))
    #     web.append(user_webinar_link.is_watched)
    #
    #     mass.append(web)
    #
    # context['webinars'] = mass
    return render(request, 'courses/my.html', context=context)


def add(request):
    if request.method == 'GET':
        return render(request, 'courses/add.html', context={'alert': ''})
    elif request.method == 'POST':
        response = request.POST
        url: str = response['url']
        email: str = response['email']
        password: str = response['password']

        if 'http://' in url:
            url = url.replace('http://', '')
        elif 'https://' in url:
            url = url.replace('https://', '')
        host = url.split('/')[0]

        # get_course = GetCourse(host)
        # res = get_course.login(email, password)
        # if not res[0]:
        #     return render(request, 'courses/add.html', context={'alert': res[1]})
        # trenings = get_course.get_all_trenings()
        return render(request, 'courses/add_show.html', context={'url': f'/courses/prepeare_add?h={host}&e={email}&p={password}'})
def prepeare_add(request):
    response = request.GET
    # url: str = response['url']
    # email: str = response['email']
    # password: str = response['password']
    #
    # if 'http://' in url:
    #     url = url.replace('http://', '')
    # elif 'https://' in url:
    #     url = url.replace('https://', '')
    # host = url.split('/')[0]

    trenings = {'Взрослое родительство':[{'Взрослое Родительство-10':[{'Взрослое Родительство-10 Продвинутый и Премиум':[{'Пост-навигатор':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234583450','lesson'],'ПРАВИЛА':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234528177','lesson'],'ВАЖНО!':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234527345','lesson'],'1 уровень ВР-10':[{'Материалы Уровень 1.':[{'Вводный урок':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234528198','lesson'],'Урок 1. 1 уровень. 1 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234528200','lesson'],'Самостоятельное засыпание у младенцев':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234528208','lesson'],'Урок 2. 1 уровень. 2 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234610007','lesson'],'Нарушение сна у младенца. Причины и профилактика.':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611338','lesson'],'Видео няня Джо Фрост':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611576','lesson'],'Урок 3. 1 уровень. 3 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611716','lesson'],'Чек-лист Режим дня':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611752','lesson'],'Полезные статьи про сон':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234613578','lesson'],'Запись эфира "Вопрос-ответ 1 уровень"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234612844','lesson'],'Мастер-класс "Родители могут все"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234717006','lesson']},'module'],'Задания Уровень 1. Продвинутый':[{'Знакомство пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235134816','lesson'],'Задание 1 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234583730','lesson'],'Задание 2 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234610046','lesson'],'Задание 3 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234613495','lesson']},'module']},'module'],'2 уровень ВР-10':[{'Материалы Уровень 2.':[{'Урок 4. 2 уровень. 1 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234612253','lesson'],'Особенности развития детей в возрасте 0-2 лет':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234719073','lesson'],'Статья про близнецов':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234601682','lesson'],'Урок 5. 2 уровень. 2 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611520','lesson'],'Статья про детский плач':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235018419','lesson'],'Урок 6. 2 уровень. 3 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611514','lesson'],'Оригами для мозгов':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235019055','lesson'],'Как отлучить ребенка от груди?':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235019130','lesson'],'Как приучить ребенка к горшку':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235019071','lesson'],'Урок 7.  2 уровень. 4 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611510','lesson'],'Самостоятельная игра':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235019082','lesson'],'Урок 8.  2 уровень. 5 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234611505','lesson'],'Основные правила введения первого прикорма':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235019108','lesson'],'15 минут на диванчике':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/236549057','lesson'],'Запись эфира "Вопрос-ответ 2 уровень"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234719800','lesson'],'Вопросы Валентине к прямому эфиру ( 1 и 2 уровни)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808225','lesson'],'Вопрос-ответ 1 и 2 уровни. Прямой эфир 21:00 МСК':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808231','lesson']},'module'],'Задания Уровень 2. Продвинутый':[{'Задание 4 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234717547','lesson'],'Задание 5 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234719633','lesson'],'Задание 6 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234719848','lesson'],'Задание 7 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234719888','lesson'],'Задание 8 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234719919','lesson']},'module']},'module'],'3 уровень ВР-10':[{'Материалы Уровень 3.':[{'Урок 9. 3 уровень. 1 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234614470','lesson'],'Особенности развития детей от 2 до 6 лет':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721164','lesson'],'Как помочь ребенку преодолеть боязнь темноты':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721200','lesson'],'Урок 10. 3 уровень. 2 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234614471','lesson'],'Урок 11. 3 уровень. 3 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234614472','lesson'],'Ночной энурез':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721265','lesson'],'Урок 12. 3 уровень. 4 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234614473','lesson'],'Запись эфира "Вопрос-ответ 3 уровень"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721324','lesson'],'Вопросы Валентине к прямому эфиру (3 уровень)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721277','lesson'],'Вопрос-ответ 3 уровень. Прямой эфир 17:00 МСК':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721315','lesson']},'module'],'Задания и срочные вопросы Уровень 3. Продвинутый':[{'Срочные вопросы кураторам пакет Продвинутый 3 уровень':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234720943','lesson'],'Задание 9 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234614495','lesson'],'Задание 10 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721235','lesson'],'Задание 11 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721254','lesson'],'Задание 12 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721310','lesson']},'module']},'module'],'4 уровень ВР-10':[{'Материалы Уровень 4.':[{'Подведем промежуточные итоги':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721342','lesson'],'Урок 13. 4 уровень. 1 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721392','lesson'],'Особенности развития детей от 6 до 13 лет':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721341','lesson'],'Чек-листы планирование с детьми':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808927','lesson'],'Урок 14. 4 уровень. 2 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721394','lesson'],'ЧТО ДОЛЖЕН УМЕТЬ ДОШКОЛЬНИК?':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234809566','lesson'],'Урок 15. 4 уровень. 3 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721395','lesson'],'О словах':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721349','lesson'],'Детский онанизм':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234809817','lesson'],'Урок 16. 4 уровень. 4 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721397','lesson'],'Почему дети обманывают':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234809841','lesson'],'Запись эфира "Вопрос-ответ 4 уровень"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721353','lesson'],'Вопросы Валентине к прямому эфиру (4 уровень)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721354','lesson'],'Вопрос-ответ 4 уровень. Прямой эфир 17:00 МСК':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721355','lesson']},'module'],'Задания и срочные вопросы Уровень 4. Продвинутый':[{'Срочные вопросы кураторам пакет Продвинутый 4 уровень':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721337','lesson'],'Задание 13 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721339','lesson'],'Задание 14 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721344','lesson'],'Задание 15 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721347','lesson'],'Задание 16 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234721351','lesson']},'module']},'module'],'5 уровень ВР-10':[{'Материалы Уровень 5.':[{'Урок 17. 5 уровень. 1 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808335','lesson'],'Урок 18. 5 уровень. 2 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808336','lesson'],'Урок 19. 5 уровень. 3 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808337','lesson'],'Урок 20. 5 уровень. 4 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808339','lesson'],'Урок 21. 5 уровень. 5 часть':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808342','lesson'],'Запись эфира "Вопрос-ответ 5 уровень"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808092','lesson'],'Вопросы Валентине к прямому эфиру (5 уровень)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808160','lesson'],'Вопрос-ответ 5 уровень. Прямой эфир 14:00 МСК':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808165','lesson'],'Экзамен по курсу "Взрослое Родительство"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235188160','lesson'],'Искусство говорить подростку "нет" (БОНУС)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/241318327','lesson'],'Как изучать с детьми Священное Писание(БОНУС)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/241318657','lesson'],'№1 первый вебинар «Свобода от акне» (БОНУС)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/241318673','lesson'],'№2 первый вебинар «Свобода от акне» (БОНУС)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/241318676','lesson'],'№3 первый вебинар «Свобода от акне» (БОНУС)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/241318680','lesson'],'Ответы на вопросы от Валентины Сибиряковой  (БОНУС)':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/241319917','lesson']},'module'],'Задания и срочные вопросы Уровень 5. Продвинутый':[{'Срочные вопросы кураторам пакет Продвинутый 5 уровень':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234808109','lesson'],'Задание 17 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234812890','lesson'],'Задание 18 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234818463','lesson'],'Задание 19 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234818684','lesson'],'Задание 20 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234819100','lesson'],'Задание 21 пакет Продвинутый':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234819533','lesson']},'module']},'module']},'module']},'module']},'module'],'Мастер-классы':[{'Мастер-класс "Охота на собственного мужа" без обратной связи':[{'Мастер-класс "Охота на собственного мужа"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642192','lesson'],'Разбор отчетов 1':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642213','lesson'],'Разбор отчетов 2':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642288','lesson'],'Разбор отчетов 3':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642296','lesson'],'Разбор отчетов 4':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642324','lesson'],'Разбор отчетов 5':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642331','lesson'],'Разбор отчетов 6':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642333','lesson'],'Разбор отчетов 7':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642335','lesson'],'Разбор отчетов 8':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642340','lesson'],'Разбор отчетов  9':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642346','lesson'],'Разбор отчетов 10':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642355','lesson'],'Финальный разбор отчетов 11':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235642359','lesson']},'module']},'module'],'Отзывы о тренингах и мастер-классах':[{'Отзывы о тренинге "Охота на собственного мужа"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234025424','lesson'],'Отзывы о тренинге  "Взрослое родительство"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/234806360','lesson'],'Отзывы о тренинге "Гениальная уборка"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/235814555','lesson'],'Отзывы о тренинге "Квантовый скачок"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/236441545','lesson'],'Отзывы о мастер-классе "Меню Раз и Навсегда"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/241499398','lesson'],'Отзывы о тренинге "12 шагов к порядку в финансах"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/266114334','lesson'],'Отзывы о Мастер-классах "МЕГА Марафона по воспитанию детей от МЕГА МАМЫ"':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/272532213','lesson'],'Отзывы о Мастер-классе «Навигация жизни или Карьерная стратегия»':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/275119897','lesson'],'Отзывы о мастер-классе «Организованный ребенок или Дети могут все»':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/281357349','lesson'],'Отзывы о мастер-классе «Порядок в одно касание»':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/286266957','lesson']},'module'],'Как работать в личном кабинете':[{'Что делать, если ссылка не открывается':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/227211865','lesson'],'Подключение уведомлений':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/227586471','lesson'],'Работа с черновиком ДЗ':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/227636850','lesson'],'Как установить ссылку входа в кабинет на рабочий стол своего компьютера':['https://valentina-krasnikova.ru/teach/control/lesson/view/id/239784153','lesson']},'module']}
    return HttpResponse(json.dumps(trenings))